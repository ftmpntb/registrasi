<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Festival Teater Modern Pelajar se-NTB tahun 2025 - PENDAFTARAN DITUTUP</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap');
        
        * {
            font-family: 'Poppins', sans-serif;
        }
        
        .gradient-bg {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 50%, #f093fb 100%);
            min-height: 100vh;
        }
        
        .glass-card {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            box-shadow: 0 25px 45px rgba(0, 0, 0, 0.1);
        }
        
        .input-modern {
            transition: all 0.3s ease;
            border: 2px solid #e5e7eb;
        }
        
        .input-modern:focus {
            border-color: #667eea;
            box-shadow: 0 0 0 4px rgba(102, 126, 234, 0.1);
            transform: translateY(-2px);
        }
        
        .btn-primary {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            transition: all 0.3s ease;
        }
        
        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 25px rgba(102, 126, 234, 0.3);
        }
        
        .btn-secondary {
            background: linear-gradient(135deg, #48bb78 0%, #38a169 100%);
            transition: all 0.3s ease;
        }
        
        .btn-secondary:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 25px rgba(72, 187, 120, 0.3);
        }
        
        .card-hover {
            transition: all 0.3s ease;
        }
        
        .card-hover:hover {
            transform: translateY(-5px);
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.15);
        }
        
        .theater-icon {
            font-size: 4rem;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
        
        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        .animate-fadeInUp {
            animation: fadeInUp 0.6s ease-out;
        }
        
        .error-text {
            color: #ef4444;
            font-size: 0.875rem;
            margin-top: 0.25rem;
        }
        
        .success-text {
            color: #10b981;
            font-size: 0.875rem;
            margin-top: 0.25rem;
        }

        .disabled-overlay {
            position: relative;
        }

        .disabled-overlay::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(255, 255, 255, 0.8);
            backdrop-filter: blur(2px);
            border-radius: 1rem;
            z-index: 10;
        }

        .disabled-text {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: linear-gradient(135deg, #ef4444 0%, #dc2626 100%);
            color: white;
            padding: 1rem 2rem;
            border-radius: 2rem;
            font-weight: bold;
            font-size: 1.25rem;
            z-index: 11;
            text-align: center;
            box-shadow: 0 10px 25px rgba(239, 68, 68, 0.3);
        }
    </style>
</head>
<body class="gradient-bg">
    <!-- Floating Header -->
    <header class="fixed top-0 left-0 right-0 z-40 bg-white/90 backdrop-blur-md shadow-lg">
        <div class="container mx-auto px-4 sm:px-6 lg:px-8 py-4">
            <div class="flex flex-col sm:flex-row items-center justify-center text-center">
                <div>
                    <h1 class="text-xl sm:text-2xl lg:text-3xl font-bold text-gray-800">Festival Teater Modern Pelajar</h1>
                    <p class="text-sm sm:text-base text-gray-600">se-NTB tahun 2025 - <span class="text-red-600 font-bold">PENDAFTARAN DITUTUP</span></p>
                </div>
            </div>
        </div>
    </header>

    <!-- Main Content -->
    <main class="pt-32 pb-20 px-4 sm:px-6 lg:px-8">
        <div class="container mx-auto max-w-6xl">
            
            <!-- Auth Section -->
            <div id="authSection" class="animate-fadeInUp">
                <div class="max-w-md mx-auto">
                    <div class="glass-card rounded-2xl p-6 sm:p-8">
                        <div class="text-center mb-8">
                            <h2 id="authTitle" class="text-2xl sm:text-3xl font-bold text-gray-800 mb-2">Masuk ke Akun</h2>
                            <p class="text-gray-600">Kelola pendaftaran festival teater</p>
                            <div class="mt-4 bg-red-50 border border-red-200 rounded-xl p-4">
                                <p class="text-red-700 font-semibold">âš ï¸ PENDAFTARAN SUDAH DITUTUP</p>
                                <p class="text-red-600 text-sm mt-1">Registrasi akun baru tidak tersedia. Hanya login untuk melihat data.</p>
                            </div>
                        </div>
                        
                        <!-- Login Form -->
                        <form id="loginForm" class="space-y-6">
                            <div>
                                <label class="block text-sm font-semibold text-gray-700 mb-3">Username</label>
                                <input type="text" id="loginUsername" class="w-full px-4 py-4 rounded-xl input-modern" required>
                            </div>
                            <div>
                                <label class="block text-sm font-semibold text-gray-700 mb-3">Password</label>
                                <input type="password" id="loginPassword" class="w-full px-4 py-4 rounded-xl input-modern" required>
                            </div>
                            <button type="submit" class="w-full btn-primary text-white py-4 rounded-xl font-semibold text-lg">
                                Masuk
                            </button>
                        </form>

                        <!-- Register Form - DISABLED -->
                        <form id="registerForm" class="space-y-6 hidden disabled-overlay">
                            <div class="disabled-text">
                                PENDAFTARAN DITUTUP
                            </div>
                            <div>
                                <label class="block text-sm font-semibold text-gray-700 mb-3">Username</label>
                                <input type="text" id="regUsername" class="w-full px-4 py-4 rounded-xl input-modern" 
                                       maxlength="7" pattern="[a-zA-Z0-9]+" required disabled>
                                <div id="usernameError" class="error-text hidden">Username maksimal 7 karakter, hanya huruf dan angka</div>
                                <div id="usernameSuccess" class="success-text hidden">Username valid âœ“</div>
                            </div>
                            <div>
                                <label class="block text-sm font-semibold text-gray-700 mb-3">Password (Huruf & Angka)</label>
                                <input type="password" id="regPassword" class="w-full px-4 py-4 rounded-xl input-modern" required disabled>
                            </div>
                            <button type="submit" class="w-full bg-gray-400 text-white py-4 rounded-xl font-semibold text-lg cursor-not-allowed" disabled>
                Pendaftaran Ditutup
                            </button>
                        </form>

                        <div class="text-center mt-8">
                            <button id="toggleAuth" class="text-gray-400 cursor-not-allowed font-semibold transition-colors" disabled>
                                Pendaftaran akun baru sudah ditutup
                            </button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Dashboard Section -->
            <div id="dashboardSection" class="hidden animate-fadeInUp">
                <div class="glass-card rounded-2xl p-6 sm:p-8 mb-8">
                    <div class="flex flex-col sm:flex-row justify-between items-center mb-8">
                        <div>
                            <h2 class="text-2xl sm:text-3xl font-bold text-gray-800 mb-2">Dashboard</h2>
                            <p id="welcomeUser" class="text-gray-600"></p>
                            <div class="mt-2 bg-yellow-50 border border-yellow-200 rounded-xl p-3 inline-block">
                                <p class="text-yellow-700 text-sm">ğŸ“¢ <strong>Mode View Only:</strong> Data tidak dapat diubah</p>
                            </div>
                        </div>
                        <button id="logoutBtn" class="mt-4 sm:mt-0 bg-red-500 hover:bg-red-600 text-white px-6 py-3 rounded-xl font-semibold transition-all hover:transform hover:-translate-y-1">
                            Keluar
                        </button>
                    </div>
                    
                    <!-- Payment Status Card -->
                    <div id="paymentStatusCard" class="glass-card rounded-2xl p-6 mb-6 border-l-4" style="border-left-color: #f59e0b;">
                        <div class="flex items-center justify-between">
                            <div class="flex items-center gap-4">
                                <div class="text-3xl">ğŸ’³</div>
                                <div>
                                    <h3 class="text-lg font-bold text-gray-800">Status Pembayaran</h3>
                                    <p id="paymentStatusText" class="text-sm text-gray-600">Memuat status...</p>
                                </div>
                            </div>
                            <div id="paymentStatusBadge" class="px-4 py-2 rounded-full text-sm font-semibold">
                                Memuat...
                            </div>
                        </div>
                    </div>

                    <div class="grid sm:grid-cols-2 lg:grid-cols-4 gap-6">
                        <button id="schoolDataBtn" class="card-hover bg-gradient-to-br from-blue-500 to-blue-600 text-white p-8 rounded-2xl text-left group">
                            <div class="text-4xl mb-4">ğŸ“š</div>
                            <h3 class="text-xl font-bold mb-3">Data Sekolah</h3>
                            <p class="text-blue-100 group-hover:text-white transition-colors">Lihat informasi sekolah dan sanggar</p>
                        </button>
                        <button id="registrationBtn" class="card-hover bg-gradient-to-br from-green-500 to-green-600 text-white p-8 rounded-2xl text-left group">
                            <div class="text-4xl mb-4">ğŸ‘¥</div>
                            <h3 class="text-xl font-bold mb-3">Registrasi Peserta</h3>
                            <p class="text-green-100 group-hover:text-white transition-colors">Lihat peserta yang sudah terdaftar</p>
                        </button>
                        <button id="paymentBtn" class="card-hover bg-gradient-to-br from-orange-500 to-orange-600 text-white p-8 rounded-2xl text-left group">
                            <div class="text-4xl mb-4">ğŸ’°</div>
                            <h3 class="text-xl font-bold mb-3">Status Pembayaran</h3>
                            <p class="text-orange-100 group-hover:text-white transition-colors">Lihat status pembayaran</p>
                        </button>
                        <button id="checkParticipantsBtn" class="card-hover bg-gradient-to-br from-purple-500 to-purple-600 text-white p-8 rounded-2xl text-left group">
                            <div class="text-4xl mb-4">ğŸ“‹</div>
                            <h3 class="text-xl font-bold mb-3">Cek Peserta Terdaftar</h3>
                            <p class="text-purple-100 group-hover:text-white transition-colors">Lihat peserta yang sudah terdaftar</p>
                        </button>
                    </div>
                </div>
            </div>

            <!-- School Data Form -->
            <div id="schoolDataSection" class="hidden animate-fadeInUp">
                <div class="glass-card rounded-2xl p-6 sm:p-8 disabled-overlay">
                    <div class="disabled-text">
                        DATA TIDAK DAPAT DIUBAH<br>
                        <span class="text-sm font-normal">Pendaftaran sudah ditutup</span>
                    </div>
                    <div class="flex flex-col sm:flex-row justify-between items-center mb-8">
                        <div>
                            <h2 class="text-2xl sm:text-3xl font-bold text-gray-800 mb-2">ğŸ“š Data Sekolah</h2>
                            <p class="text-gray-600">Lihat informasi sekolah dan sanggar</p>
                        </div>
                        <button id="backToDashboard1" class="mt-4 sm:mt-0 bg-gray-500 hover:bg-gray-600 text-white px-6 py-3 rounded-xl font-semibold transition-all hover:transform hover:-translate-y-1">
                            Kembali
                        </button>
                    </div>
                    
                    <form id="schoolForm" class="space-y-6">
                        <div class="grid sm:grid-cols-2 gap-6">
                            <div>
                                <label class="block text-sm font-semibold text-gray-700 mb-3">Nama Sekolah</label>
                                <input type="text" id="schoolName" class="w-full px-4 py-4 rounded-xl bg-gray-100 text-gray-600" readonly>
                            </div>
                            <div>
                                <label class="block text-sm font-semibold text-gray-700 mb-3">Nama Sanggar</label>
                                <input type="text" id="sanggarName" class="w-full px-4 py-4 rounded-xl bg-gray-100 text-gray-600" readonly>
                            </div>
                        </div>
                        
                        <div>
                            <label class="block text-sm font-semibold text-gray-700 mb-3">Unggah Naskah</label>
                            <input type="text" class="w-full px-4 py-4 rounded-xl bg-gray-100 text-gray-600" value="File sudah diupload (tidak dapat diubah)" readonly>
                        </div>
                        
                        <div>
                            <label class="block text-sm font-semibold text-gray-700 mb-3">Unggah Plot Lampu</label>
                            <input type="text" class="w-full px-4 py-4 rounded-xl bg-gray-100 text-gray-600" value="File sudah diupload (tidak dapat diubah)" readonly>
                        </div>
                        
                        <div>
                            <label class="block text-sm font-semibold text-gray-700 mb-3">Unggah Poster Pertunjukan</label>
                            <input type="text" class="w-full px-4 py-4 rounded-xl bg-gray-100 text-gray-600" value="File sudah diupload (tidak dapat diubah)" readonly>
                        </div>
                        
                        <div>
                            <label class="block text-sm font-semibold text-gray-700 mb-3">Unggah Artistik</label>
                            <input type="text" class="w-full px-4 py-4 rounded-xl bg-gray-100 text-gray-600" value="File sudah diupload (tidak dapat diubah)" readonly>
                        </div>
                        
                        <div>
                            <label class="block text-sm font-semibold text-gray-700 mb-3">Unggah Sinopsis</label>
                            <input type="text" class="w-full px-4 py-4 rounded-xl bg-gray-100 text-gray-600" value="File sudah diupload (tidak dapat diubah)" readonly>
                        </div>
                        
                        <div>
                            <label class="block text-sm font-semibold text-gray-700 mb-3">Unggah Profil Sanggar</label>
                            <input type="text" class="w-full px-4 py-4 rounded-xl bg-gray-100 text-gray-600" value="File sudah diupload (tidak dapat diubah)" readonly>
                        </div>
                        
                        <div>
                            <label class="block text-sm font-semibold text-gray-700 mb-3">Kontak Pembina</label>
                            <input type="text" id="supervisorContact" class="w-full px-4 py-4 rounded-xl bg-gray-100 text-gray-600" readonly>
                        </div>
                        
                        <button type="button" class="w-full bg-gray-400 text-white py-4 rounded-xl font-semibold text-lg cursor-not-allowed" disabled>
                            Data Tidak Dapat Diubah (Pendaftaran Ditutup)
                        </button>
                    </form>
                </div>
            </div>

            <!-- Check Participants Section -->
            <div id="checkParticipantsSection" class="hidden animate-fadeInUp">
                <div class="glass-card rounded-2xl p-6 sm:p-8">
                    <div class="flex flex-col sm:flex-row justify-between items-center mb-8">
                        <div>
                            <h2 class="text-2xl sm:text-3xl font-bold text-gray-800 mb-2">ğŸ“‹ Peserta Terdaftar</h2>
                            <p class="text-gray-600">Lihat peserta yang sudah terdaftar</p>
                            <div class="mt-2 bg-yellow-50 border border-yellow-200 rounded-xl p-3 inline-block">
                                <p class="text-yellow-700 text-sm">ğŸ“¢ Data peserta tidak dapat diubah atau dihapus</p>
                            </div>
                        </div>
                        <button id="backToDashboard3" class="mt-4 sm:mt-0 bg-gray-500 hover:bg-gray-600 text-white px-6 py-3 rounded-xl font-semibold transition-all hover:transform hover:-translate-y-1">
                            Kembali
                        </button>
                    </div>
                    
                    <!-- Loading State -->
                    <div id="participantsLoading" class="text-center py-12">
                        <div class="animate-spin rounded-full h-12 w-12 border-b-2 border-purple-600 mx-auto mb-4"></div>
                        <p class="text-gray-600">Memuat data peserta...</p>
                    </div>
                    
                    <!-- Empty State -->
                    <div id="participantsEmpty" class="hidden text-center py-12">
                        <div class="text-6xl mb-4">ğŸ‘¥</div>
                        <h3 class="text-xl font-bold text-gray-800 mb-2">Belum Ada Peserta</h3>
                        <p class="text-gray-600 mb-6">Belum ada peserta yang terdaftar untuk sekolah Anda</p>
                    </div>
                    
                    <!-- Participants List -->
                    <div id="participantsList" class="hidden space-y-4">
                        <!-- Participants will be loaded here -->
                    </div>
                </div>
            </div>

            <!-- Edit Participant Modal - DISABLED -->
            <div id="editParticipantModal" class="fixed inset-0 bg-black bg-opacity-50 backdrop-blur-sm z-50 hidden">
                <div class="flex items-center justify-center min-h-screen p-4">
                    <div class="glass-card rounded-2xl p-6 sm:p-8 max-w-md w-full max-h-[90vh] overflow-y-auto disabled-overlay">
                        <div class="disabled-text">
                            EDIT DITUTUP
                        </div>
                        <div class="flex justify-between items-center mb-6">
                            <h3 class="text-xl font-bold text-gray-800">âœï¸ Edit Peserta</h3>
                            <button id="closeEditModal" class="text-gray-500 hover:text-gray-700 text-2xl">Ã—</button>
                        </div>
                        
                        <div class="text-center py-8">
                            <div class="text-4xl mb-4">ğŸš«</div>
                            <h4 class="text-lg font-bold text-gray-800 mb-2">Edit Tidak Tersedia</h4>
                            <p class="text-gray-600">Pendaftaran sudah ditutup. Data peserta tidak dapat diubah.</p>
                        </div>
                        
                        <div class="flex gap-3 pt-4">
                            <button id="cancelEdit" class="flex-1 bg-gray-500 hover:bg-gray-600 text-white py-3 rounded-xl font-semibold">
                                Tutup
                            </button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Payment Section -->
            <div id="paymentSection" class="hidden animate-fadeInUp">
                <div class="glass-card rounded-2xl p-6 sm:p-8">
                    <div class="flex flex-col sm:flex-row justify-between items-center mb-8">
                        <div>
                            <h2 class="text-2xl sm:text-3xl font-bold text-gray-800 mb-2">ğŸ’° Status Pembayaran</h2>
                            <p class="text-gray-600">Lihat status pembayaran pendaftaran</p>
                            <div class="mt-2 bg-yellow-50 border border-yellow-200 rounded-xl p-3 inline-block">
                                <p class="text-yellow-700 text-sm">ğŸ“¢ Upload bukti pembayaran sudah ditutup</p>
                            </div>
                        </div>
                        <button id="backToDashboard4" class="mt-4 sm:mt-0 bg-gray-500 hover:bg-gray-600 text-white px-6 py-3 rounded-xl font-semibold transition-all hover:transform hover:-translate-y-1">
                            Kembali
                        </button>
                    </div>
                    
                    <!-- Payment Information -->
                    <div class="bg-gradient-to-r from-orange-50 to-yellow-50 border border-orange-200 rounded-2xl p-6 mb-8">
                        <div class="flex items-start gap-4">
                            <div class="text-3xl">ğŸ¦</div>
                            <div class="flex-1">
                                <h3 class="text-xl font-bold text-gray-800 mb-4">Informasi Pembayaran</h3>
                                <div class="space-y-3 text-gray-700">
                                    <div class="flex items-center gap-3">
                                        <span class="font-semibold text-orange-600">ğŸ’° Biaya:</span>
                                        <span class="text-lg font-bold">Rp. 350.000,00 (Tiga Ratus Lima Puluh Ribu Rupiah)</span>
                                    </div>
                                    <div class="flex items-center gap-3">
                                        <span class="font-semibold text-orange-600">ğŸ¦ Bank:</span>
                                        <span>BRI</span>
                                    </div>
                                    <div class="flex items-center gap-3">
                                        <span class="font-semibold text-orange-600">ğŸ“± No. Rekening:</span>
                                        <span class="font-mono bg-white px-3 py-1 rounded border">3495-01-046321-533</span>
                                    </div>
                                    <div class="flex items-center gap-3">
                                        <span class="font-semibold text-orange-600">ğŸ‘¤ Atas Nama:</span>
                                        <span>Teater Putih</span>
                                    </div>
                                </div>
                                
                                <div class="mt-6 p-4 bg-blue-50 border border-blue-200 rounded-xl">
                                    <div class="flex items-start gap-3">
                                        <div class="text-2xl">ğŸ“</div>
                                        <div>
                                            <h4 class="font-semibold text-blue-800 mb-2">Pembayaran Langsung</h4>
                                            <p class="text-blue-700 text-sm">
                                                Pembayaran juga dapat dilakukan langsung ke Sekretariat UKMF Teater Putih di 
                                                <strong>Gedung Ormawa Lantai 2, Jalan Majapahit No. 62 FKIP Universitas Mataram</strong>
                                            </p>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Payment Status Display -->
                    <div id="currentPaymentStatus" class="mb-8">
                        <!-- Will be populated by JavaScript -->
                    </div>
                    
                    <!-- Payment Upload Form - DISABLED -->
                    <div class="bg-gray-50 border border-gray-200 rounded-2xl p-6 text-center">
                        <div class="text-4xl mb-4">ğŸ”’</div>
                        <h3 class="text-xl font-bold text-gray-800 mb-2">Upload Bukti Pembayaran Ditutup</h3>
                        <p class="text-gray-600">Periode upload bukti pembayaran sudah berakhir.</p>
                    </div>
                </div>
            </div>

            <!-- Registration Form -->
            <div id="registrationSection" class="hidden animate-fadeInUp">
                <div class="glass-card rounded-2xl p-6 sm:p-8 disabled-overlay">
                    <div class="disabled-text">
                        PENDAFTARAN PESERTA DITUTUP
                    </div>
                    <div class="flex flex-col sm:flex-row justify-between items-center mb-8">
                        <div>
                            <h2 class="text-2xl sm:text-3xl font-bold text-gray-800 mb-2">ğŸ‘¥ Data Peserta Terdaftar</h2>
                            <p class="text-gray-600">Lihat peserta yang sudah terdaftar</p>
                        </div>
                        <button id="backToDashboard2" class="mt-4 sm:mt-0 bg-gray-500 hover:bg-gray-600 text-white px-6 py-3 rounded-xl font-semibold transition-all hover:transform hover:-translate-y-1">
                            Kembali
                        </button>
                    </div>
                    
                    <div class="text-center py-12">
                        <div class="text-6xl mb-4">ğŸ”’</div>
                        <h3 class="text-2xl font-bold text-gray-800 mb-4">Pendaftaran Peserta Ditutup</h3>
                        <p class="text-gray-600 mb-6">Periode pendaftaran peserta sudah berakhir. Data tidak dapat ditambah atau diubah.</p>
                        <button onclick="showSection('checkParticipants')" class="btn-primary text-white px-6 py-3 rounded-xl font-semibold">
                            Lihat Daftar Peserta
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <!-- Footer -->
    <footer class="bg-gray-900/90 backdrop-blur-md text-white py-8">
        <div class="container mx-auto px-4 sm:px-6 lg:px-8 text-center">
            <h3 class="text-xl font-bold mb-2">Festival Teater Modern Pelajar se-NTB tahun 2025 - <span class="text-red-400">PENDAFTARAN DITUTUP</span></h3>
        </div>
    </footer>

    <!-- Toast Notification -->
    <div id="toast" class="fixed top-24 right-4 transform translate-x-full transition-transform duration-300 z-50">
        <div class="glass-card rounded-xl p-4 max-w-sm">
            <div class="flex items-center">
                <div id="toastIcon" class="text-2xl mr-3"></div>
                <div>
                    <div id="toastMessage" class="font-semibold text-gray-800"></div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Global variables
        let currentUser = null;
        let schoolData = {};
        const API_URL = 'https://script.google.com/macros/s/AKfycbz2cN7ea4Mb7gNdpd0M4iS-at6drcMWnmt1d0Unlcu4oGWiI6immglM2qYc0_pYetMY/exec';
        const REGISTRATION_CLOSED = true; // Flag untuk menandai pendaftaran ditutup

        // DOM elements
        const authSection = document.getElementById('authSection');
        const dashboardSection = document.getElementById('dashboardSection');
        const schoolDataSection = document.getElementById('schoolDataSection');
        const registrationSection = document.getElementById('registrationSection');
        const checkParticipantsSection = document.getElementById('checkParticipantsSection');
        const paymentSection = document.getElementById('paymentSection');
        const loginForm = document.getElementById('loginForm');
        const registerForm = document.getElementById('registerForm');
        const authTitle = document.getElementById('authTitle');
        const toggleAuth = document.getElementById('toggleAuth');

        // Initialize
        document.addEventListener('DOMContentLoaded', function() {
            checkLoginStatus();
            setupEventListeners();
            
            // Nonaktifkan toggle auth jika pendaftaran ditutup
            if (REGISTRATION_CLOSED) {
                toggleAuth.disabled = true;
                toggleAuth.classList.add('cursor-not-allowed', 'text-gray-400');
                toggleAuth.textContent = 'Pendaftaran akun baru sudah ditutup';
            }
        });

        // Make functions globally accessible for onclick handlers
        window.editParticipant = editParticipant;
        window.deleteParticipant = deleteParticipant;

        function setupEventListeners() {
            // Forms
            loginForm.addEventListener('submit', handleLogin);
            
            // Navigation
            document.getElementById('logoutBtn').addEventListener('click', handleLogout);
            document.getElementById('schoolDataBtn').addEventListener('click', () => showSection('schoolData'));
            document.getElementById('registrationBtn').addEventListener('click', () => showSection('checkParticipants')); // Redirect ke check participants
            document.getElementById('paymentBtn').addEventListener('click', () => showSection('payment'));
            document.getElementById('checkParticipantsBtn').addEventListener('click', () => showSection('checkParticipants'));
            document.getElementById('backToDashboard1').addEventListener('click', () => showSection('dashboard'));
            document.getElementById('backToDashboard2').addEventListener('click', () => showSection('dashboard'));
            document.getElementById('backToDashboard3').addEventListener('click', () => showSection('dashboard'));
            document.getElementById('backToDashboard4').addEventListener('click', () => showSection('dashboard'));
            
            // Modal controls
            document.getElementById('closeEditModal').addEventListener('click', closeEditModal);
            document.getElementById('cancelEdit').addEventListener('click', closeEditModal);
        }

        function toggleAuthMode() {
            if (REGISTRATION_CLOSED) {
                showToast('Pendaftaran akun baru sudah ditutup', 'error');
                return;
            }
            
            const isLogin = !loginForm.classList.contains('hidden');
            
            if (isLogin) {
                loginForm.classList.add('hidden');
                registerForm.classList.remove('hidden');
                authTitle.textContent = 'Buat Akun Baru';
                toggleAuth.textContent = 'Sudah punya akun? Masuk di sini';
            } else {
                registerForm.classList.add('hidden');
                loginForm.classList.remove('hidden');
                authTitle.textContent = 'Masuk ke Akun';
                toggleAuth.textContent = 'Belum punya akun? Daftar di sini';
            }
        }

        async function handleLogin(e) {
            e.preventDefault();
            const username = document.getElementById('loginUsername').value;
            const password = document.getElementById('loginPassword').value;
            
            try {
                const response = await fetch(API_URL, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'text/plain;charset=utf-8'
                    },
                    body: JSON.stringify({
                        action: 'login',
                        username: username,
                        password: password
                    })
                });
                
                const result = await response.json();
                
                if (result.success) {
                    currentUser = username;
                    localStorage.setItem('currentUser', username);
                    localStorage.setItem('userPassword', password);
                    if (result.schoolData) {
                        schoolData = result.schoolData;
                    }
                    showSection('dashboard');
                    showToast('Login berhasil! Mode view only', 'success');
                } else {
                    showToast(result.message || 'Login gagal!', 'error');
                }
            } catch (error) {
                showToast('Terjadi kesalahan saat login', 'error');
            }
        }

        async function handleRegister(e) {
            if (REGISTRATION_CLOSED) {
                e.preventDefault();
                showToast('Pendaftaran akun baru sudah ditutup', 'error');
                return;
            }
            // Kode registrasi lama di sini (tidak akan dijalankan karena REGISTRATION_CLOSED = true)
        }

        async function handleSchoolData(e) {
            if (REGISTRATION_CLOSED) {
                e.preventDefault();
                showToast('Data tidak dapat diubah - Pendaftaran sudah ditutup', 'error');
                return;
            }
            // Kode school data lama di sini
        }

        async function handleParticipantRegistration(e) {
            if (REGISTRATION_CLOSED) {
                e.preventDefault();
                showToast('Pendaftaran peserta sudah ditutup', 'error');
                return;
            }
            // Kode participant registration lama di sini
        }

        function handleRoleChange() {
            if (REGISTRATION_CLOSED) {
                showToast('Pendaftaran peserta sudah ditutup', 'error');
                return;
            }
            // Kode role change lama di sini
        }

        function showSection(section) {
            // Hide all sections
            authSection.classList.add('hidden');
            dashboardSection.classList.add('hidden');
            schoolDataSection.classList.add('hidden');
            registrationSection.classList.add('hidden');
            checkParticipantsSection.classList.add('hidden');
            paymentSection.classList.add('hidden');
            
            // Show selected section with animation
            setTimeout(() => {
                switch(section) {
                    case 'auth':
                        authSection.classList.remove('hidden');
                        break;
                    case 'dashboard':
                        dashboardSection.classList.remove('hidden');
                        document.getElementById('welcomeUser').textContent = `Selamat datang, ${currentUser}! ğŸ‘‹ (View Only)`;
                        loadPaymentStatus();
                        break;
                    case 'schoolData':
                        schoolDataSection.classList.remove('hidden');
                        loadSchoolData();
                        break;
                    case 'registration':
                        // Redirect ke check participants karena pendaftaran ditutup
                        showSection('checkParticipants');
                        break;
                    case 'payment':
                        paymentSection.classList.remove('hidden');
                        loadCurrentPaymentStatus();
                        break;
                    case 'checkParticipants':
                        checkParticipantsSection.classList.remove('hidden');
                        loadParticipants();
                        break;
                }
            }, 100);
        }

        async function loadPaymentStatus() {
            try {
                const response = await fetch(API_URL, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'text/plain;charset=utf-8'
                    },
                    body: JSON.stringify({
                        action: 'getPaymentStatus',
                        username: currentUser
                    })
                });
                
                const result = await response.json();
                
                if (result.success) {
                    updatePaymentStatusDisplay(result.paymentStatus || 'belum_bayar');
                } else {
                    updatePaymentStatusDisplay('belum_bayar');
                }
            } catch (error) {
                updatePaymentStatusDisplay('belum_bayar');
            }
        }

        function updatePaymentStatusDisplay(status) {
            const card = document.getElementById('paymentStatusCard');
            const badge = document.getElementById('paymentStatusBadge');
            const text = document.getElementById('paymentStatusText');
            
            let statusConfig = {
                'belum_bayar': {
                    badge: 'bg-red-100 text-red-800',
                    text: 'Menunggu pembayaran',
                    border: '#ef4444',
                    icon: 'â³'
                },
                'menunggu_verifikasi': {
                    badge: 'bg-yellow-100 text-yellow-800',
                    text: 'Menunggu verifikasi',
                    border: '#f59e0b',
                    icon: 'â³'
                },
                'terverifikasi': {
                    badge: 'bg-green-100 text-green-800',
                    text: 'Pembayaran terverifikasi',
                    border: '#10b981',
                    icon: 'âœ…'
                },
                'ditolak': {
                    badge: 'bg-red-100 text-red-800',
                    text: 'Pembayaran ditolak',
                    border: '#ef4444',
                    icon: 'âŒ'
                }
            };
            
            const config = statusConfig[status] || statusConfig['belum_bayar'];
            
            card.style.borderLeftColor = config.border;
            badge.className = `px-4 py-2 rounded-full text-sm font-semibold ${config.badge}`;
            badge.textContent = config.text;
            text.innerHTML = `${config.icon} Status: ${config.text}`;
        }

        function checkLoginStatus() {
            const savedUser = localStorage.getItem('currentUser');
            const savedPassword = localStorage.getItem('userPassword');
            
            if (savedUser && savedPassword) {
                currentUser = savedUser;
                showSection('dashboard');
            } else {
                showSection('auth');
            }
        }

        function handleLogout() {
            currentUser = null;
            localStorage.removeItem('currentUser');
            localStorage.removeItem('userPassword');
            showSection('auth');
            showToast('Anda telah keluar', 'info');
        }

        function showToast(message, type = 'info') {
            const toast = document.getElementById('toast');
            const toastMessage = document.getElementById('toastMessage');
            const toastIcon = document.getElementById('toastIcon');
            
            const icons = {
                success: 'âœ…',
                error: 'âŒ',
                warning: 'âš ï¸',
                info: 'â„¹ï¸'
            };
            
            const colors = {
                success: 'text-green-600',
                error: 'text-red-600',
                warning: 'text-yellow-600',
                info: 'text-blue-600'
            };
            
            toastIcon.textContent = icons[type] || icons.info;
            toastIcon.className = `text-2xl mr-3 ${colors[type] || colors.info}`;
            toastMessage.textContent = message;
            
            toast.classList.remove('translate-x-full');
            
            setTimeout(() => {
                toast.classList.add('translate-x-full');
            }, 3000);
        }

        function closeEditModal() {
            document.getElementById('editParticipantModal').classList.add('hidden');
        }

        // Fungsi-fungsi yang tidak lagi digunakan karena pendaftaran ditutup
        function editParticipant(index) {
            if (REGISTRATION_CLOSED) {
                showToast('Edit peserta tidak tersedia - Pendaftaran sudah ditutup', 'error');
                return;
            }
            // Kode edit participant lama di sini
        }

        function deleteParticipant(index) {
            if (REGISTRATION_CLOSED) {
                showToast('Hapus peserta tidak tersedia - Pendaftaran sudah ditutup', 'error');
                return;
            }
            // Kode delete participant lama di sini
        }

        async function loadSchoolData() {
            try {
                const response = await fetch(API_URL, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'text/plain;charset=utf-8'
                    },
                    body: JSON.stringify({
                        action: 'getSchoolData',
                        username: currentUser
                    })
                });
                
                const result = await response.json();
                
                if (result.success && result.data) {
                    const data = result.data;
                    document.getElementById('schoolName').value = data.schoolName || '';
                    document.getElementById('sanggarName').value = data.sanggarName || '';
                    document.getElementById('supervisorContact').value = data.supervisorContact || '';
                }
            } catch (error) {
                showToast('Gagal memuat data sekolah', 'error');
            }
        }

        async function loadParticipants() {
            const loading = document.getElementById('participantsLoading');
            const empty = document.getElementById('participantsEmpty');
            const list = document.getElementById('participantsList');
            
            loading.classList.remove('hidden');
            empty.classList.add('hidden');
            list.classList.add('hidden');
            
            try {
                const response = await fetch(API_URL, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'text/plain;charset=utf-8'
                    },
                    body: JSON.stringify({
                        action: 'getParticipants',
                        username: currentUser
                    })
                });
                
                const result = await response.json();
                
                loading.classList.add('hidden');
                
                if (result.success && result.participants && result.participants.length > 0) {
                    displayParticipants(result.participants);
                    list.classList.remove('hidden');
                } else {
                    empty.classList.remove('hidden');
                }
            } catch (error) {
                loading.classList.add('hidden');
                showToast('Gagal memuat data peserta', 'error');
            }
        }

        function displayParticipants(participants) {
            const container = document.getElementById('participantsList');
            container.innerHTML = '';
            
            participants.forEach((participant, index) => {
                const participantCard = document.createElement('div');
                participantCard.className = 'glass-card rounded-2xl p-6 card-hover';
                participantCard.innerHTML = `
                    <div class="flex justify-between items-start">
                        <div class="flex-1">
                            <h3 class="text-xl font-bold text-gray-800 mb-2">${participant.name || 'Nama tidak tersedia'}</h3>
                            <div class="grid grid-cols-1 sm:grid-cols-2 gap-2 text-sm text-gray-600">
                                <div><strong>NISN:</strong> ${participant.nisn || '-'}</div>
                                <div><strong>Kelas:</strong> ${participant.grade || '-'}</div>
                                <div><strong>Jenis Kelamin:</strong> ${participant.gender === 'L' ? 'Laki-laki' : 'Perempuan'}</div>
                                <div><strong>Peran:</strong> ${getRoleDisplayName(participant.role)}</div>
                            </div>
                        </div>
                        <div class="flex gap-2 ml-4">
                            <button onclick="editParticipant(${index})" class="bg-gray-400 text-white px-4 py-2 rounded-lg font-semibold cursor-not-allowed" disabled>
                                Edit
                            </button>
                            <button onclick="deleteParticipant(${index})" class="bg-gray-400 text-white px-4 py-2 rounded-lg font-semibold cursor-not-allowed" disabled>
                                Hapus
                            </button>
                        </div>
                    </div>
                `;
                container.appendChild(participantCard);
            });
        }

        function getRoleDisplayName(role) {
            const roles = {
                'aktor': 'Aktor',
                'sutradara': 'Sutradara',
                'penulis_naskah': 'Penulis Naskah',
                'penata_artistik': 'Penata Artistik',
                'penata_cahaya': 'Penata Cahaya',
                'penata_musik': 'Penata Musik',
                'crew': 'Crew Panggung'
            };
            return roles[role] || role;
        }

        async function loadCurrentPaymentStatus() {
            try {
                const response = await fetch(API_URL, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'text/plain;charset=utf-8'
                    },
                    body: JSON.stringify({
                        action: 'getPaymentStatus',
                        username: currentUser
                    })
                });
                
                const result = await response.json();
                
                const container = document.getElementById('currentPaymentStatus');
                
                if (result.success) {
                    const status = result.paymentStatus || 'belum_bayar';
                    const statusText = getPaymentStatusText(status);
                    
                    container.innerHTML = `
                        <div class="glass-card rounded-2xl p-6 border-l-4" style="border-left-color: ${getStatusColor(status)};">
                            <div class="flex items-center justify-between">
                                <div class="flex items-center gap-4">
                                    <div class="text-3xl">${getStatusIcon(status)}</div>
                                    <div>
                                        <h3 class="text-lg font-bold text-gray-800">Status Pembayaran Saat Ini</h3>
                                        <p class="text-sm text-gray-600">${statusText}</p>
                                    </div>
                                </div>
                                <div class="px-4 py-2 rounded-full text-sm font-semibold ${getStatusBadgeClass(status)}">
                                    ${getStatusBadgeText(status)}
                                </div>
                            </div>
                        </div>
                    `;
                } else {
                    container.innerHTML = `
                        <div class="glass-card rounded-2xl p-6 border-l-4 border-red-500">
                            <div class="text-center text-gray-600">
                                <p>Gagal memuat status pembayaran</p>
                            </div>
                        </div>
                    `;
                }
            } catch (error) {
                document.getElementById('currentPaymentStatus').innerHTML = `
                    <div class="glass-card rounded-2xl p-6 border-l-4 border-red-500">
                        <div class="text-center text-gray-600">
                            <p>Terjadi kesalahan saat memuat status pembayaran</p>
                        </div>
                    </div>
                `;
            }
        }

        function getPaymentStatusText(status) {
            switch(status) {
                case 'belum_bayar': return 'Menunggu pembayaran';
                case 'menunggu_verifikasi': return 'Pembayaran sedang diverifikasi';
                case 'terverifikasi': return 'Pembayaran telah diverifikasi';
                case 'ditolak': return 'Pembayaran ditolak - Silakan periksa kembali bukti transfer';
                default: return 'Status tidak diketahui';
            }
        }

        function getStatusColor(status) {
            switch(status) {
                case 'terverifikasi': return '#10b981';
                case 'menunggu_verifikasi': return '#f59e0b';
                case 'ditolak': return '#ef4444';
                default: return '#6b7280';
            }
        }

        function getStatusIcon(status) {
            switch(status) {
                case 'terverifikasi': return 'âœ…';
                case 'menunggu_verifikasi': return 'â³';
                case 'ditolak': return 'âŒ';
                default: return 'ğŸ’°';
            }
        }

        function getStatusBadgeClass(status) {
            switch(status) {
                case 'terverifikasi': return 'bg-green-100 text-green-800';
                case 'menunggu_verifikasi': return 'bg-yellow-100 text-yellow-800';
                case 'ditolak': return 'bg-red-100 text-red-800';
                default: return 'bg-gray-100 text-gray-800';
            }
        }

        function getStatusBadgeText(status) {
            switch(status) {
                case 'terverifikasi': return 'Terverifikasi';
                case 'menunggu_verifikasi': return 'Menunggu Verifikasi';
                case 'ditolak': return 'Ditolak';
                default: return 'Belum Bayar';
            }
        }
    </script>
</body>
</html>
